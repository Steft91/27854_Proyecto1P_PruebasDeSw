<div class="App">

  <div *ngIf="!isAuthenticated" class="login-wrapper" style="display: flex; justify-content: center; align-items: center; min-height: 80vh;">
    
    <div class="form-container" style="width: 100%; max-width: 400px; padding: 2rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
      
      <ng-container *ngIf="!showRegister">
        <h2 style="text-align: center; margin-bottom: 1.5rem;">Iniciar Sesi贸n</h2>
        
        <form (ngSubmit)="onLogin()" #loginForm="ngForm" class="data-form">
          
          <div class="form-group">
            <label for="username">Usuario</label>
            <input 
              type="text" 
              id="username" 
              [(ngModel)]="loginData.username" 
              name="username" 
              required 
              autocomplete="username"
              placeholder="Ej: admin">
          </div>

          <div class="form-group" style="margin-top: 1rem;">
            <label for="password">Contrase帽a</label>
            <input 
              type="password" 
              id="password" 
              [(ngModel)]="loginData.password" 
              name="password" 
              required 
              autocomplete="current-password"
              placeholder="******">
          </div>

          <p *ngIf="loginError" class="error-text" style="color: #dc3545; margin-top: 1rem; text-align: center;">
            {{ loginError }}
          </p>

          <div class="form-actions" style="margin-top: 1.5rem; flex-direction: column; gap: 10px;">
            <button type="submit" class="btn-primary" [disabled]="!loginForm.form.valid" style="width: 100%;">
              Ingresar
            </button>
            
            <div style="text-align: center; margin-top: 1rem; border-top: 1px solid #e2e8f0; padding-top: 1rem;">
              <p style="font-size: 0.9rem; color: #64748b; margin-bottom: 0.5rem;">驴No tienes cuenta?</p>
              <button type="button" class="btn-secondary" (click)="toggleRegister()" style="width: 100%;">
                Crear Cuenta
              </button>
            </div>
          </div>
        </form>
      </ng-container>

      <ng-container *ngIf="showRegister">
        <app-register 
          (cancel)="toggleRegister()" 
          (registerSuccess)="toggleRegister()">
        </app-register>
      </ng-container>

    </div>
  </div>

  <div *ngIf="isAuthenticated">
    
    <header class="app-header">
      <div style="display: flex; justify-content: space-between; align-items: center; max-width: 1200px; margin: 0 auto; padding: 0 20px;">
        <div>
          <h1> Sistema de Gesti贸n</h1>
          <p class="subtitle">Supermercado - Panel Administrativo</p>
        </div>
        <button (click)="onLogout()" class="btn-secondary" style="background-color: #ff1f2d; border: 1px solid #e30613; color: white;">
          Cerrar Sesi贸n
        </button>
      </div>
    </header>

    <nav class="tabs">
      <button [class.active]="activeTab === 'clientes'" (click)="cambiarTab('clientes')" class="tab">
         Clientes
      </button>
      <button [class.active]="activeTab === 'proveedores'" (click)="cambiarTab('proveedores')" class="tab">
         Proveedores
      </button>
      <button [class.active]="activeTab === 'productos'" (click)="cambiarTab('productos')" class="tab">
         Productos
      </button>
      <button [class.active]="activeTab === 'empleados'" (click)="cambiarTab('empleados')" class="tab">
         Empleados
      </button>
    </nav>

    <main class="content">
      
      <div *ngIf="activeTab === 'clientes'" class="tab-content fade-in">
        <app-cliente-form
          [clienteEditar]="clienteEditar"
          (guardar)="onClienteGuardado()" 
          (cancelar)="cancelarEdicion()">
        </app-cliente-form>

        <app-clientes-list
          #listaClientes
          (editar)="setEditCliente($event)">
        </app-clientes-list>
      </div>

      <div *ngIf="activeTab === 'proveedores'" class="tab-content fade-in">
        <app-proveedor-form
          [proveedorEditar]="proveedorEditar"
          (guardar)="onProveedorGuardado()"
          (cancelar)="cancelarEdicion()">
        </app-proveedor-form>

        <app-proveedor-list
          #listaProveedores
          (editar)="setEditProveedor($event)">
        </app-proveedor-list>
      </div>

      <div *ngIf="activeTab === 'productos'" class="tab-content fade-in">
        <app-producto-form
          [productoEditar]="productoEditar"
          (guardar)="onProductoGuardado()"
          (cancelar)="cancelarEdicion()">
        </app-producto-form>

        <app-productos-list
          #listaProductos
          (editar)="setEditProducto($event)">
        </app-productos-list>
      </div>

      <div *ngIf="activeTab === 'empleados'" class="tab-content fade-in">
        <app-empleado-form
          [empleadoEditar]="empleadoEditar"
          (guardar)="onEmpleadoGuardado()"
          (cancelar)="cancelarEdicion()">
        </app-empleado-form>

        <app-empleados-list
          #listaEmpleados
          (editar)="setEditEmpleado($event)">
        </app-empleados-list>
      </div>

    </main>

    <footer class="app-footer">
      <p>漏 2025 Sistema de Gesti贸n de Supermercado - Refactorizaci贸n Angular</p>
    </footer>

  </div>
</div>